<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Interaktiver Fragebogen – Schreibmaschinen-Effekt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts: Raleway (Light) -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300&display=swap" rel="stylesheet">
  <style>
    /* Dark Mode – mit Raleway als Hauptschrift */
    body {
      font-family: 'Raleway', sans-serif;
      background: #121212;
      margin: 0;
      padding: 0;
      color: #e0e0e0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    /* Container */
    #chat-container {
      width: 500px;
      max-width: 90%;
      background: #1e1e1e;
      border: 1px solid #333;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
    }
    /* Chat-Bereich */
    #chat {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      border-bottom: 1px solid #333;
    }
    /* Nachrichten */
    .message {
      margin-bottom: 20px;
    }
    .bot {
      font-size: 1.5em;
      font-weight: 300;  /* Leichtgewichtig */
      color: #ffffff;
    }
    .user {
      text-align: right;
      color: #4fc3f7;
      font-size: 1.2em;
    }
    /* Eingabebereich */
    #input-area {
      display: flex;
      padding: 20px;
      background: #181818;
    }
    #input-area input {
      flex: 1;
      padding: 12px;
      border: 1px solid #333;
      border-radius: 4px;
      font-size: 1em;
      background: #262626;
      color: #e0e0e0;
    }
    #input-area button {
      padding: 12px 20px;
      margin-left: 10px;
      border: none;
      background: #4fc3f7;
      color: #121212;
      border-radius: 4px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #input-area button:hover {
      background: #38b0e3;
    }
  </style>
</head>
<body>
  <div id="chat-container">
    <div id="chat"></div>
    <div id="input-area">
      <input type="text" id="user-input" placeholder="Deine Antwort ..." />
      <button id="send-btn">Senden</button>
    </div>
  </div>

  <script>
    // Array mit den Fragen
    const questions = [
      "Was ist das Ziel deines Suchens?",
      "Wann möchtest du das Ganze beginnen und wie lange soll es gehen?",
      "Was ist der Status Quo bzw. was ist der Wissensstand deines Vorhabens oder deiner Projektteilnehmer?"
    ];
    
    let currentQuestionIndex = 0;
    let sessionData = {
      timestamp: new Date().toISOString(),
      responses: {}
    };

    const chatDiv = document.getElementById("chat");
    const inputField = document.getElementById("user-input");
    const sendBtn = document.getElementById("send-btn");

    // Typewriter-Funktion: Zeigt Text Buchstabe für Buchstabe an
    function typeWriterEffect(target, text, index, callback) {
      if (index < text.length) {
        target.innerHTML += text.charAt(index);
        setTimeout(() => {
          typeWriterEffect(target, text, index + 1, callback);
        }, 50); // 50 Millisekunden pro Buchstabe
      } else {
        if (callback) callback();
      }
    }

    // Zeigt die nächste Frage mit Typewriter-Effekt an
    function showNextQuestion() {
      if (currentQuestionIndex < questions.length) {
        const msgDiv = document.createElement("div");
        msgDiv.classList.add("message", "bot");
        chatDiv.appendChild(msgDiv);
        msgDiv.innerHTML = "";
        typeWriterEffect(msgDiv, questions[currentQuestionIndex], 0, () => {
          chatDiv.scrollTop = chatDiv.scrollHeight;
        });
      } else {
        addMessage("Vielen Dank! Deine Antworten wurden gespeichert.", "bot");
        saveSessionData(sessionData);
      }
    }

    // Fügt eine Nachricht sofort hinzu (für User-Antworten)
    function addMessage(text, sender) {
      const msgDiv = document.createElement("div");
      msgDiv.classList.add("message", sender);
      msgDiv.innerText = text;
      chatDiv.appendChild(msgDiv);
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    // Verarbeitet User-Antworten und zeigt die nächste Frage an
    function processAnswer() {
      const answer = inputField.value.trim();
      if (answer === "") return;
      addMessage(answer, "user");
      
      // Speichere die Antwort in der Session
      switch (currentQuestionIndex) {
        case 0: sessionData.responses.ziel = answer; break;
        case 1: sessionData.responses.zeitplanung = answer; break;
        case 2: sessionData.responses.status_quo = answer; break;
      }
      inputField.value = "";
      currentQuestionIndex++;
      setTimeout(showNextQuestion, 500);
    }
    
    // Speichert die Session-Daten per POST an den Google Apps Script-Web-App-Endpunkt
    function saveSessionData(data) {
      // Ersetze die URL unten durch die URL, die du beim Deployment deiner Web-App erhalten hast
      const endpoint = "https://script.google.com/macros/s/YOUR_WEB_APP_ID/exec";
      fetch(endpoint, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(result => {
        console.log("Session gespeichert:", result);
      })
      .catch(error => {
        console.error("Fehler beim Speichern:", error);
      });
    }
    
    // Event-Listener
    sendBtn.addEventListener("click", processAnswer);
    inputField.addEventListener("keypress", function(e) {
      if (e.key === "Enter") processAnswer();
    });
    
    // Startet den Fragebogen
    showNextQuestion();
  </script>
</body>
</html>
