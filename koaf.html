<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Interaktiver Fragebogen – Schreibmaschinen-Effekt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts: Roboto -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    /* Grundstil – Dark Mode */
    body {
      font-family: 'Roboto', sans-serif;
      background: #121212;
      margin: 0;
      padding: 0;
      color: #e0e0e0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    /* Container */
    #chat-container {
      width: 500px;
      max-width: 90%;
      background: #1e1e1e;
      border: 1px solid #333;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
    }
    /* Chat-Bereich */
    #chat {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      border-bottom: 1px solid #333;
    }
    /* Nachrichten */
    .message {
      margin-bottom: 20px;
    }
    .bot {
      font-size: 1.5em;
      font-weight: bold;
      color: #ffffff;
    }
    .user {
      text-align: right;
      color: #4fc3f7;
      font-size: 1.2em;
    }
    /* Eingabebereich */
    #input-area {
      display: flex;
      padding: 20px;
      background: #181818;
    }
    #input-area input {
      flex: 1;
      padding: 12px;
      border: 1px solid #333;
      border-radius: 4px;
      font-size: 1em;
      background: #262626;
      color: #e0e0e0;
    }
    #input-area button {
      padding: 12px 20px;
      margin-left: 10px;
      border: none;
      background: #4fc3f7;
      color: #121212;
      border-radius: 4px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #input-area button:hover {
      background: #38b0e3;
    }
  </style>
</head>
<body>
  <div id="chat-container">
    <div id="chat"></div>
    <div id="input-area">
      <input type="text" id="user-input" placeholder="Deine Antwort ..." />
      <button id="send-btn">Senden</button>
    </div>
  </div>

  <script>
    // Array mit den Fragen
    const questions = [
      "Was ist das Ziel deines Suchens?",
      "Wann möchtest du das Ganze beginnen und wie lange soll es gehen?",
      "Was ist der Status Quo bzw. was ist der Wissensstand deines Vorhabens oder deiner Projektteilnehmer?"
    ];
    
    let currentQuestionIndex = 0;
    let sessionData = {
      timestamp: new Date().toISOString(),
      responses: {}
    };

    const chatDiv = document.getElementById("chat");
    const inputField = document.getElementById("user-input");
    const sendBtn = document.getElementById("send-btn");

    /**
     * Funktion: typeWriterEffect
     * Zeigt den Text buchstabeweise an.
     * @param {HTMLElement} target - Element, in dem der Text angezeigt wird
     * @param {string} text - Der anzuzeigende Text
     * @param {number} index - Aktuelle Position im Text (Start = 0)
     * @param {function} callback - Funktion, die nach Fertigstellen aufgerufen wird
     */
    function typeWriterEffect(target, text, index, callback) {
      if (index < text.length) {
        target.innerHTML += text.charAt(index);
        setTimeout(() => {
          typeWriterEffect(target, text, index + 1, callback);
        }, 50);  // Delay von 50 Millisekunden pro Buchstabe
      } else {
        if (callback) callback();
      }
    }

    /**
     * Funktion: showNextQuestion
     * Zeigt die nächste Frage mit typewriter-Effekt an.
     */
    function showNextQuestion() {
      if (currentQuestionIndex < questions.length) {
        const msgDiv = document.createElement("div");
        msgDiv.classList.add("message", "bot");
        chatDiv.appendChild(msgDiv);
        // Leeren des Texts und Start des Typewriter-Effekts
        msgDiv.innerHTML = "";
        typeWriterEffect(msgDiv, questions[currentQuestionIndex], 0, function() {
          chatDiv.scrollTop = chatDiv.scrollHeight;
        });
      } else {
        addMessage("Vielen Dank! Deine Antworten wurden gespeichert.", "bot");
        saveSessionData(sessionData);
      }
    }

    /**
     * Funktion: addMessage
     * Fügt eine Nachricht sofort hinzu (z. B. für User-Antworten).
     * @param {string} text - Nachrichtentext
     * @param {string} sender - "bot" oder "user"
     */
    function addMessage(text, sender) {
      const msgDiv = document.createElement("div");
      msgDiv.classList.add("message", sender);
      msgDiv.innerText = text;
      chatDiv.appendChild(msgDiv);
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    /**
     * Funktion: processAnswer
     * Verarbeitet die Antwort des Users, speichert sie und zeigt die nächste Frage.
     */
    function processAnswer() {
      const answer = inputField.value.trim();
      if (answer === "") return;
      addMessage(answer, "user");
      
      // Speichern der Antworten in der Session-Daten-Struktur
      switch (currentQuestionIndex) {
        case 0: sessionData.responses.ziel = answer; break;
        case 1: sessionData.responses.zeitplanung = answer; break;
        case 2: sessionData.responses.status_quo = answer; break;
      }
      inputField.value = "";
      currentQuestionIndex++;
      // Warte kurz und zeige dann die nächste Frage
      setTimeout(showNextQuestion, 500);
    }
    
    /**
     * Funktion: saveSessionData
     * Hier werden die gesammelten Session-Daten gespeichert.
     * Momentan wird das nur in der Konsole ausgegeben.
     * Zum Speichern ohne eigenen Server könntest du z. B. Firebase verwenden.
     */
    function saveSessionData(data) {
      console.log("Session gespeichert:", data);
      // Hier könnte ein API-Aufruf stehen, z.B. an Firebase
    }
    
    // Event-Listener für Button-Klick und Enter-Taste
    sendBtn.addEventListener("click", processAnswer);
    inputField.addEventListener("keypress", function(e) {
      if (e.key === "Enter") processAnswer();
    });
    
    // Starte den Fragebogen mit der ersten Frage
    showNextQuestion();
  </script>
</body>
</html>
